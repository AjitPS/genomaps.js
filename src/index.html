<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <!-- build:css styles/genemap-lib.css -->
    <!-- bower:css -->
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:css styles/genemap.css -->
    <!-- inject:css -->
    <link rel="stylesheet" href="css/annotations.css">
    <link rel="stylesheet" href="css/bootstrap-namespaced.css">
    <link rel="stylesheet" href="css/chromosome.css">
    <link rel="stylesheet" href="css/chromosome_cell.css">
    <link rel="stylesheet" href="css/infobox.css">
    <link rel="stylesheet" href="css/mapview.css">
    <!-- endinject -->
    <!-- endbuild -->

    <style>
      svg {
        border: 1px solid black;
      }

      html, body {
        height: 100%;
      }

      #map {
        width: 80%;
        height: 80%;
      }

      #box {
        height: 100px;
        width: 100px;
        background-color: red;
      }
    </style>

  </head>

  <body>

    <span>Basemap:</span>

    <select id="basemap-file" onclick="redraw();">
      <option value='arabidopsis'>Arabidopsis</option>
      <option value='barley'>Barley</option>
      <option value='boleracea'>Boleracea</option>
      <option value='chicken'>Chicken</option>
      <option value='cow'>Cow</option>
      <option value='maize'>Maize</option>
      <option selected="selected" value='poplar'>Poplar</option>
      <option value='pig'>Pig</option>
      <option value='potato'>Potato</option>
      <option value='wheat'>Wheat</option>
      <option value='simple'>Simple</option>
    </select>

    <!-- <span>Show Labels</span><input id="show-labels" type="checkbox" value="show" /> -->
    <span>Num Per Row:</span>

    <input id="chromosome_per_row" type="number" min="1" value="10" style="width:30px;" onclick="redraw();"/>
    <input id="chk-annotations" type="checkbox" checked="true" onclick="redraw();"> Include Annotations
    <button onclick="redraw(false)">Draw</button>
    <button onclick="redraw(true)">Reset Zoom</button>

    <div id="map" class="bootstrap"></div>

    <div id="box"></div>

    <!-- build:js js/genemap-lib.js -->
    <!-- bower:js -->
    <script src="jquery/jquery.js"></script>
    <script src="bootstrap/dist/js/bootstrap.js"></script>
    <script src="d3/d3.js"></script>
    <script src="lodash/lodash.js"></script>
    <script src="d3.promise/dist/d3.promise.min.js"></script>
    <script src="labella/dist/labella.min.js"></script>
    <script src="hammerjs/hammer.js"></script>
    <script src="jquery-hammerjs/jquery.hammer.js"></script>
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:js js/genemap.js -->
    <!-- inject:js -->
    <script src="js/annotations.js"></script>
    <script src="js/annotation_xml_reader.js"></script>
    <script src="js/auto_layout.js"></script>
    <script src="js/basemap_xml_reader.js"></script>
    <script src="js/chromosome.js"></script>
    <script src="js/chromosome_cell.js"></script>
    <script src="js/genemap.js"></script>
    <script src="js/infobox.js"></script>
    <script src="js/map_layout.js"></script>
    <script src="js/xml_data_reader.js"></script>
    <!--endinject -->
    <!-- endbuild -->

    <script>
      var chart = GENEMAP.GeneMap();

      // redraw on window resize
      var resize = function () {
        chart.redraw('#map');
      };

      d3.select(window).on('resize', resize);

      var redraw = function (resetZoom) {
        var sel = document.getElementById('basemap-file');
        var file = 'basemap/' + sel.options[sel.selectedIndex].value + '.xml';

        var numberPerRow = +document.getElementById('chromosome_per_row').value;
        chart.layout().numberPerRow = numberPerRow;

        // chart.layout().showAnnotationLabels = document.querySelector('#show-labels').checked;

        if (resetZoom) {
          chart.resetZoom();
        }

        var annotationFile = null;
        var includeAnnotations = document.getElementById('chk-annotations').checked;

        if (includeAnnotations) {
          annotationFile = 'annotations/' + sel.options[sel.selectedIndex].value + '.xml';
        }

        chart.draw('#map', file, annotationFile);
      };

      redraw();

      $('#box').hammer().on('press', function () {
        console.log('press', this);
      });

    </script>

  </body>
</html>
