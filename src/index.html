<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <!-- build:css styles/lib.css -->
    <!-- bower:css -->
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:css styles/genemap.css -->
    <!-- inject:css -->
    <link rel="stylesheet" href="css/annotations.css">
    <link rel="stylesheet" href="css/bootstrap-namespaced.css">
    <link rel="stylesheet" href="css/chromosome.css">
    <link rel="stylesheet" href="css/infobox.css">
    <link rel="stylesheet" href="css/mapview.css">
    <!-- endinject -->
    <!-- endbuild -->

    <style>
      svg {
        border: 1px solid black;
      }

      html, body {
        height: 100%;
      }

      #map {
        width: 80%;
        height: 80%;
      }
    </style>

  </head>

  <body>

    <span>Basemap:</span>

    <select id="basemap-file">
      <option selected="selected" value='poplar_basemap.xml'>Poplar</option>
      <option value='wheat_basemap.xml'>Wheat</option>
      <option value='simple_basemap.xml'>Simple</option>
    </select>

    <!-- <span>Show Labels</span><input id="show-labels" type="checkbox" value="show" /> -->
    <span>Num Per Row:</span>

    <input id="chromosome_per_row" type="number" min="1" value="10" style="width:30px;"/>
    <button onclick="redraw(false)">Draw</button>
    <button onclick="redraw(true)">Reset Zoom</button>

    <div id="map" class="bootstrap"></div>

    <!-- build:js js/lib.js -->
    <!-- bower:js -->
    <script src="jquery/dist/jquery.js"></script>
    <script src="bootstrap/dist/js/bootstrap.js"></script>
    <script src="d3/d3.js"></script>
    <script src="lodash/lodash.js"></script>
    <script src="d3.promise/dist/d3.promise.min.js"></script>
    <script src="labella/dist/labella.min.js"></script>
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:js js/genemap.js -->
    <!-- inject:js -->
    <script src="js/annotations.js"></script>
    <script src="js/annotation_xml_reader.js"></script>
    <script src="js/auto_layout.js"></script>
    <script src="js/basemap_xml_reader.js"></script>
    <script src="js/chromosome.js"></script>
    <script src="js/genemap.js"></script>
    <script src="js/infobox.js"></script>
    <script src="js/map_layout.js"></script>
    <script src="js/xml_data_reader.js"></script>
    <!--endinject -->
    <!-- endbuild -->

    <script>
      var chart = GENEMAP.GeneMap();

      // redraw on window resize
      var resize = function () {
        chart.redraw('#map');
      };

      d3.select(window).on('resize', resize);

      var redraw = function (resetZoom) {
        var sel = document.getElementById('basemap-file');
        var file = sel.options[sel.selectedIndex].value;

        var numberPerRow = +document.getElementById('chromosome_per_row').value;
        chart.layout().numberPerRow = numberPerRow;

        // chart.layout().showAnnotationLabels = document.querySelector('#show-labels').checked;

        if (resetZoom) {
          chart.resetZoom();
        }

        var annotationFile = null;
        if (file.indexOf('poplar') > -1) {
          annotationFile = 'annotations/poplar_gene_qtl_matches.xml';
        }

        chart.draw('#map', file, annotationFile);
      };

      redraw();

    </script>

  </body>
</html>
