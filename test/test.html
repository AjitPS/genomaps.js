<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="../css/annotations.css" />
    <link rel="stylesheet" href="../css/chromosome.css" />
    <link rel="stylesheet" href="../css/mapview.css" />

  </head>

  <body>

    <span>Basemap:</span>
    <select id="basemap-file">
      <option selected="selected" value='./data/poplar_basemap.xml'>Poplar</option>
      <option value='./data/wheat_basemap.xml'>Wheat</option>
      <option value='./data/simple_basemap.xml'>Simple</option>
    </select>
    <!-- <span>Show Labels</span><input id="show-labels" type="checkbox" value="show" /> -->
    <span>Num Per Row:</span>
    <input id="chromosome_per_row" type="number" min="1" value="10" style="width:30px;"/>
    <button onclick="redraw(false)">Draw</button>
    <button onclick="redraw(true)">Reset Zoom</button>

    <div id="map"></div>
    <script src="../d3/d3.min.js"></script>
    <script src="../js/lodash/lodash.min.js"></script>
    <script src="../js/d3.promise/d3.promise.min.js"></script>
    <script src="../chromosome.js"></script>
    <script src="../annotations.js"></script>
    <script src="../basemap_xml_reader.js"></script>
    <script src="../annotation_xml_reader.js"></script>
    <script src="../xml_data_reader.js"></script>
    <script src="../map_layout.js"></script>
    <script src="../auto_layout.js"></script>
    <script src="../genemap.js"></script>

    <script>
      var chart = GENEMAP.GeneMap();

      // redraw on window resize
      var resize =function() {
        chart.redraw("#map");
      }

      d3.select(window).on('resize', resize);

      var redraw = function(resetZoom){
        var sel = document.getElementById('basemap-file');
        var file = sel.options[sel.selectedIndex].value;

        var numberPerRow = +document.getElementById('chromosome_per_row').value;
        chart.layout().numberPerRow = numberPerRow;

        // chart.layout().showAnnotationLabels = document.querySelector('#show-labels').checked;

        if (resetZoom){
          chart.resetZoom();
        }

        var annotationFile = null;
        if (file.indexOf('poplar') > -1 ){
          annotationFile = "./data/annotations/poplar_gene_qtl_matches.xml"
        }

        chart.draw('#map', file, annotationFile);
      }

      redraw();

    </script>

  </body>
</html>
