<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="style.css" />

  </head>

  <body>

    <span>Basemap:</span>
    <select id="basemap-file">
      <option selected="selected" value='./data/poplar_basemap.xml'>Poplar</option>
      <option value='./data/wheat_basemap.xml'>Wheat</option>
      <option value='./data/simple_basemap.xml'>Simple</option>
    </select>
    <span>Num Per Row:</span>
    <input id="chromosome_per_row" type="number" min="1" value="10" style="width:30px;"/>
    <button onclick="redraw(false)">Draw</button>
    <button onclick="redraw(true)">Reset Zoom</button>

    <div id="map"></div>
    <script src="../d3/d3.min.js"></script>
    <script src="../js/lodash/lodash.min.js"></script>
    <script src="../chromosome.js"></script>
    <script src="../xml_reader.js"></script>
    <script src="../map_layout.js"></script>
    <script src="../auto_layout.js"></script>
    <script src="../genemap.js"></script>

    <script>
      var chart = GENEMAP.GeneMap({
        margins: { top:50 }
      });

      // redraw on window resize
      var resize =function() {
        d3.select('#map').call(chart);
      }

      d3.select(window).on('resize', resize);

      var drawChart = function(data) {
        d3.select("#map")
          .datum(data)
          .call(chart);
      };

      var reader = GENEMAP.XmlReader();

      var redraw = function(resetZoom){
        var sel = document.getElementById('basemap-file');
        var file = sel.options[sel.selectedIndex].value;

        var numberPerRow = +document.getElementById('chromosome_per_row').value;
        chart.layout().numberPerRow = numberPerRow;

        if (resetZoom){
          chart.resetZoom();
        }

        reader.readBasemapXML(file, drawChart);
      }
      redraw();

    </script>

  </body>
</html>
